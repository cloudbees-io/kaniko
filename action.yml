apiVersion: automation.cloudbees.io/v1alpha1
kind: action
name: 'Kaniko build and push'
description: 'Build and publish Docker images from a Dockerfile using Kaniko'
inputs:
  dockerconfigjson:
    description: 'Dockerconfigjson contains the registry and registry credentials'
  dockerfile:
    description: 'Path to the Dockerfile'
  context:
    description: 'Docker build context'
    default: ${{ cloudbees.workspace }}
  destination: 
    description: 'Target image(s) that will be published to the registries configured in the dockerconfigjson'
  build-args:
    description: 'Docker build arguments'
  labels:
    description: 'Metadata to be associated with the resulting image'
runs:
  using: composite
  steps:
    - id: build-and-publish-docker-image
      name: Build and publish Docker image
      uses: docker://registry.saas-dev.beescloud.com/staging/kaniko-action:latest
